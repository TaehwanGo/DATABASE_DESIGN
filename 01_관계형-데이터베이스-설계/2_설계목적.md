# 2. 설계 목적

#### 이 장에서 다루는 주제

- 왜 데이터베이스 설계에 관심을 가져야 하는가
- 이론의 중요성
- 훌륭한 설계 방법론을 학습함으로써 얻는 이점
- 훌륭한 설계의 목적
- 훌륭한 설계의 이점
- 데이터베이스 설계 방법
- 정규화
- 요약
- 연습문제

## 왜 데이터 베이스 설계에 관심을 가져야 하는가

- 사용자의 필요에 따라 복사 및 수정이 가능한 예제 데이터베이스를 가지고 있고
  - 예제 데이터베이스를 참고해 다른 데이터베이스를 만들 수도 있다
- 논리적 데이터베이스 구조를 설계한 이후에 이런 도구들을 사용하는 것이 더 좋다는 것을 받아들여야 한다
- RDBMS 프로그램들은 물리적으로 데이터베이스를 구현하는 데 소요되는 시간을 최소화 할 수 있도록 설계 도구 및 예제 데이터베이스를 제공한다
  - 구현 시간 단축 => 응용 프로그램작성 및 구축하는 데 더 집중할 수 있음
- 그러나 데이터 베이스의 설계에 관심을 가져야 하는 주된 이유는

  - 데이터베이스 내의 데이터의 일관성, 무결성, 정확성에 결정적으로 중요하기 때문
  - 부정확한 정보 -> 잘못된 데이터베이스 설계의 가장 최악의 결과

- 집 짓는 것을 예로 들어보자

  - 건축 설계사를 고용 -> 새로운 집 설계
  - 건축설계사 => 건축크기, 모양, 다양한 시스템에 대한 요구사항을 기록할 청사진을 작성
  - 건축업자 -> 일꾼과 나열된 시스템을 포함한 자재들을 조달하고 도면 및 명세서에 따라 집을 짓는다

- 논리적 데이터베이스 설계를 건축 설계의 청사진으로 생각하고 물리적 데이터베이스 구현을 집을 짓는 것으로 생각
  - 논리적 DB 설계 ~= 건축 설계의 청사진
  - 물리적 DB 구현 ~= 집 짓기
  - 논리적 DB 설계
    - 크기, 모양, 데이터베이스에 필요한 시스템 등 => 현업의 운영 요구사항, 정보를 표현
    - RDBMS 프로그램을 사용 -> 논리적 데이터베이스 설계를 물리적으로 구현
    - 테이블 만들기 -> 테이블 간 관계 설정 -> 적절한 수준의 무결성을 설정
    - 응용프로그램이 정확한 정보를 적시에 제공할 것을 확실할 수 있다
- 훌륭한 설계를 구현하는 것
  - 정확한 정보를 제공
  - 효율적이고 효과적으로 데이터를 저장
  - 더욱 쉽게 유지보수를 할 수 있게 해줌

### 이론의 중요성

- 이론의 주요 이점 : 결과를 예측할 수 있게 도와준다
- 이론은 관계형 데이터베이스를 생성하는 데 필요한 기초 구조물들을 설명하고
- 그것들을 배열하는 방법에 대한 지침을 제공한다
- 원하는 결과를 얻기 위해 기초 구조물을 배열하는 것을 "설계"라고 정의한다

### 훌륭한 설계 방법론을 배움으로써 얻는 이점

- 시행착오를 통해서도 배울 수 있지만 이는 많은 시간이 걸린다
- 가장 좋은 방법은 훌륭한 데이터베이스 설계 방법론을 배우는 것이며, 그런 다음 데이터베이스 설계에 착수하는 것이다
- 설계 방법론을 학습하고 사용함으로써 얻는 이점들
  - 견고한 데이터베이스 구조를 설계하는 데 필요한 기술을 제공한다
    - 무결성을 보장하며 설계
  - 단계적으로 설계 프로세스를 알려줄 조직화된 기술 집합을 제공한다
    - 조직화된 기술 -> 설계의 모든 측면에서 정보에 근거한 결정을 내릴 수 있게 해준다
  - 실수와 설계 반복을 최소한으로 줄여준다
    - 훌륭한 방법론은 설계 오류를 인식하고 이를 해결하기 위한 도구를 제공한다
    - 방법론에 있는 조직화된 기술은 설계 프로세스 내 불필요한 반복 작업을 피하도록 도와줄 것이다
  - 설계 프로세스를 쉽게 만들며 데이터베이스의 설계에 소요되는 시간을 줄여준다
    - 설계에 임의의 시행착오적 방식을 사용하게 될 경우, 훌륭한 방법론에서 제공하는 논리와 조직화가 부족하기 때문에 틀림없이 귀중한 시간을 낭비하게 될 것이다
  - RDBMS 응용프로그램을 보다 더 완벽하고 효과적으로 이해하고 사용하는 데 도움을 준다
    - 적절한 설계에 대한 지식이 확장되고 성장함에 따라 주어진 RDBMS가 특정 도구들을 제공하는 이유와
    - RDBMS 프로그램 내에서 구조를 구현하는 데 이 도구들을 어떻게 사용해야 할지 이해하기 시작할 것이다

### 훌륭한 설계의 목적

- 목적들에 초점을 맞추어 설계한다면 앞에서 언급한 많은 문제들을 방지할 수 있을 것이다
- 데이터베이스는 필수 및 임의적인 정보 검색을 모두 지원한다
  - 설계과정에서 정의한 요구사항 뿐만 아니라
  - 사용자에 의해 제기될 수 있는 임의의 질의를 지원하기 위해 필요한 데이터는 반드시 저장해야 한다
- 테이블은 적절하고 효율적으로 구성되어야 한다
  - 데이터베이스의 각 테이블은 하나의 제목을 나타내며
  - 상대적으로 구별되는 필드들로 구성되어
  - 중복 데이터를 절대적으로 최소화하고
  - 고유값을 가진 필드에 의해 데이터베이스에서 식별된다
- 필드, 테이블, 관계 수준에서 데이터 무결성이 부과된다
  - 이러한 무결성의 수준들은 데이터 구조와 그것의 값이 유효하고 항상 정확할 것이라는 것을 보증한다
- 데이터베이스는 조직과 관련된 업무 규칙을 지원한다
  - 데이터는 항상 업무에 의미가 유효하고 정확한 정보를 제공해야한다
- 데이터베이스는 자체의 미래성장에 적합하다
  - 데이터베이스 구조는 업무 변화나 성장에 따른 정보 요구사항에 의해 확장하거나 수정하기 쉬워야 한다

### 훌륭한 설계의 이점

- 좋은 설계 -> 수정할 필요가 없음 -> 시간 절감
- 데이터베이스 구조를 쉽게 수정할 수 있고 운영할 수 있다
  - 테이블이나 필드에 대한 수정이 데이터베이스의 다른 필드나 테이블에 부정적인 영향을 주지 않는다
- 데이터를 쉽게 수정할 수 있다
  - 테이블 내 필드값 변경 -> 다른 곳에 영향을 주지 않음
- 정보를 쉽게 검색할 수 있다
  - 테이블이 잘 구성되어 있고 그 관계가 제대로 설정되어있다
- 최종 사용자 응용프로그램을 개발하고 구축하기가 쉽다
  - 좋은 설계 -> 수정할 필요가 없음 -> 시간 절감 -> 프로그래밍과 데이터 조작 작업에 더 많은 시간을 사용할 수 있음

### 데이터베이스 설계 방법

#### 전통적인 설계 방법

- 일반적으로 데이터베이스 설계의 전통적인 방법은 3단계를 포함한다
  - 요구사항 분석
  - 데이터 모델링
  - 정규화
- 요구사항 분석 단계
  - 모델이 되는 사업에 대한 조사
  - 현재 시스템을 평가하고 미래의 요구를 분석하기 위한 사용자와 관리자와의 면담
    - 전체 사업에 대한 정보 요구 사항의 평가 등
  - 이 책에서 다루는 설계 프로세스는 비슷한 사고 방식을 따른다
- 데이터 모델링 단계
  - 엔티티-관계 다이어그램(ERD), 의미-개체(semantic-object) 모델링, 개체-관계(object-role) 모델링 또는 UML 모델링과 같은
  - 데이터 모델링 방법을 사용하여 데이터베이스 구조를 설계하는 것을 포함한다
  - 테이블, 테이블 관계, 관계 특성과 같은 데이터베이스 구조의 다양한 측면을 시각적으로 표현하는 수단을 제공한다
  - 이 책에서 사용된 모델링 방법은 ERD의 기본적인 버전이다
  - 이 책에선 모델링 방법을 따로 다루지 않고 설계 프로세스에 통합시켰다
    - 각 과정에서 적절하게 각 모델링 기법을 소개하고 설명한다
  - `Agents` -> (`1:N` 관계) -> `Client`
    - 테이블 두개 : Agent, Client
    - 1:N 관계
  - 각 테이블에는 기본 키를 할당하고 데이터 무결성의 다양한 수준이 식별 및 구현되며, 외래 키(foreign key)를 통해 관계가 설정된다
  - 테이블 구조가 완성되고 데이터 모델에 따른 관계를 구축하고 나면 데이터베이스는 정규화 과정으로 나아갈 준비가 된다
- 정규화 단계
  - 불필요한 데이터와 중복 데이터를 제거하고, 데이터 삽입, 업데이트 또는 삭제에서 발생하는 문제를 방지하기 위해
    - 큰 테이블을 작은 테이블들로 분해하는 과정이다
  - 정규화 과정에서 테이블 구조를 정규형(normal form)에 대해서 테스트를 수행한 후 앞에서 언급한 문제들이 발견된 경우 수정한다
  - 각기 특정한 문제의 집합을 테스트하는 데 사용되는 정규형들이 존재한다
  - 제 1 ~ 4 정규형, 보이스 코드(Boyce-Codd), 정규형, 도메인/키 정규형이다

#### 이 책에서 제시된 설계 방법

- 이 책에서 사용하는 설계 방법은 저자가 수년간 개발해온 것이다
- 요구사항 분석 및 데이터베이스 구조를 그리기 위한 간단한 ERD 방법을 포함한다
- 그러나 전통적인 정규화 과정을 통합하거나 정규형의 사용을 포함하고 있지는 않다
  - 그 이유는 정규형은 정형화된 관계형 데이터베이스 이론을 배우기 위해 시간을 투자하지 않은 사람에게 다소 혼란을 줄 수 있기 때문이다
  - 예를 들어 제 3 정규형의 다음과 같은 정의를 검토해보자
    - 제2정규형(2NF)에 있으며 키가 아닌 모든 속성들이 비이행적으로 기본 키에 종속된다면 관계 변수(relation variable)는 제 3정규형(3NF) 이다.
      - 이 설명은 `관계 변수`, `제 2정규형`, `제 3정규형`, `키가 아닌 속성`, `비이행적 종속`, `기본 키`와 같은 용어를 잘 알지 못하는 독자에겐 의미가 없다
- 데이터베이스를 설계하는 과정은 이해하기 어렵지도 않고 어려워서도 안된다
- 과정이 간단하게 표현되고, 각 개념과 기법이 명확하게 기술되어 있다면 누구든지 데이터베이스를 적절하게 설계할 수 있다.
  - 에, 테이블 구조에 대한 제3정규형을 사용한 결과에서 도출된 것이며,
    대부분의 사람들이 명확하고 이해하기 쉽다고 깨달을 것으로 믿는다(?)
    - 테이블은 각각의 레코드들을 유일하게 식별하는 필드를 가져야 하고, 이러한 각각의 필드들은 테이블이 나타내는 주제를 표현하여야 한다
      - 이 정의를 정형화하는 데 사용된 프로세스는 저자의 전체 설계 방법론을 개발하는 데 사용한 것과 같다

### 정규화

- 관계형 데이터 베이스 모델이 거의 20년간 존재하고 있었고
- 사람들은 약 12년 동안 같은 기본적인 방법론을 사용해서 데이터베이스를 설계해 왔다
- 당시에 전통적인 설계 방법론을 사용하고 있었지만 가끔씩 그 방법론을 적용하는 데 어려운 순간들이 존재했다
- 저자를 괴롭힌 두 가지는 `정규화 절차`와 `적절한 설계에 도달하기 위해 필요한 끝없는 반복`이었다
- 꽤 오랫동안 고민 한 끝에 저자는 해결책을 찾았다
  - 정규화의 목적이 부적절하거나 잘못 설계된 테이블을 가지고 올바른 구조의 테이블로 변환하는 것임을 알고 있었다
  - 그리고 주어진 테이블을 가지고 적절하게 설계되었는지 판단하기 위해 정규형에 대해 테스트하는 절차들도 이미 이해하고 있었다
  - 만약 제대로 설계되지 않은 경우 적정한 수준의 변경을 통해 다시 테스트하여 테이블의 구조가 올바르게 될 때까지 전체 작업을 반복한다
- 저자는 이러한 사실들을 염두에 둔 채 다음 질문들을 제기했다
  - 1. 우리는 완적한게 정규화된 테이블이 적절하고 효율적으로 설계되었다고 가정한다면
       그런 테이블의 구체적인 특징을 식별해 이상적인 테이블의 속성이라고 제기할 순 없을까?
  - 2. 설계 프로세스에서 데이터베이스를 위해 생성하는 모든 테이블을 위한 모델로 이상적인 테이블을 사용할 수 있지 않을까?
- 위 두 질문에 대한 답은 물론 "당연히 가능하다"이며, 저자는 새로운 설계 방법론을 위한 기초를 본격적으로 개발하였다
- 각 정규형의 테스트를 성공적으로 통과한 잘 정의된 데이터베이스의 최종 특성을 식별하여 정상적인 구조를 만들기 위한 고유한 가이드라인을 수집했다
- 그런 다음 새 데이터베이스의 테이블 구조를 만들고 기존 데이터베이스의 테이블 구조의 결함을 해결하기 위해
  새로운 가이드라인을 사용해 몇 가지 테스트를 실시했다
  - 이 테스트는 매우 잘 수행되었으며 전통적인 설계 방법론 전체에 이 기법을 적용하기로 결정했다
- 도메인, 서브타입, 관계, 데이터 무결성, 참조 무결성 등 기존의 설계 방법과 연관된 다른 주제를 다루기 위한 가이드라인을 공식화했다
- 새로운 가이드라인을 완성한 후에 더 많은 테스트를 수행했고 저자의 방법론은 아주 정상적으로 작동함을 알았다
- 저자의 설계 방법론의 주요 장점은 새로운 데이터베이스 개발자에게 위협적인 전통적인 설계 방법론의 여러 측면을 제거한 것이다
  - 예를 들면, 전통적 의미의 정규화는 새로운 가이드라인을 통해 설계 프로세스 전반에 통합되어 있으므로 명백해졌다
- 또 다른 주요 장점은 방법론이 명료하고 구현하기가 쉽다는 것이다

- 이 설계 방법론을 다른 설계 방법론처럼 충실히 따르기만 한다면 완전히 정규화된 데이터베이스 구조를 설계해줄 것임을 이해하는 것이 중요하다
- 이 방법론(뿐만 아니라 다을ㄴ 방법론도)의 어떠한 부분도 단축하거나 우회하거나 중시하지 않거나
  생략해서는 정상적인 구조를 개발할 수 있다고 기대하기 어렵다
- 기대하는 바를 얻기 위해서는 부지런히 조직적으로 완전하게 프로세스를 따라야할 것이다
- 부록 G "정규화"에 저자의 설계 방법론에 정규화를 통합하는 바아법에 대한 자세한 설명이 기술되어있다

### 요약

- 데이터베이스 설계에 관심을 가져야한는지와 그 중요성
- 무결성은 매우 중요하다
- 좋은 설계는 시간을 절약해준다

### 연습문제
